{% extends 'layout.html' %}
{% load crispy_forms_tags %}
{% load aroma_extras %}

{% block content %}
    <div class="contacts_space">
        <div class="container-fluid" >
            <div class="row aroma_container aroma_panel">
                <div class="col-md-9 col-sm-9" >
                    <div class="sort">
                        Сортировать:
                        <a href="?{% url_replace request 'ordering' '-year' %}"
                                {% if request.GET.ordering == '-year' or not request.GET.ordering %} class='selected'{% endif %}>
                            по новизне</a>
                        <a href="?{% url_replace request 'ordering' '-aromacounter__num_comments' %}"
                                {% if request.GET.ordering == '-aromacounter__num_comments' %} class='selected'{% endif %}>
                            по популярности</a>
                    </div>
                    {% include "item_list.html" with items=data %}
                    {% if data.page_links|length > 1 %}
                        <div class="row center">
                            {% include 'pagination.html' with previous_url=data.previous_url next_url=data.next_url page_links=data.page_links %}
                        </div>
                    {% endif %}
                </div>
                <div class="col-md-3 col-sm-3">
                    <form name="search_form" id="search_form" method="GET">
                        {% crispy form %}
                        <button type="submit" class="btn btn-search">Применить</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block extra_javascript %}
    <script>
        $('#search_form').on('change', function(){
            $('#search_form').submit();
        });
    </script>
{% endblock %}
