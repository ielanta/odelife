{% extends 'layout.html' %}
{% load crispy_forms_tags %}
{% load aroma_extras %}

{% block content %}
    <div class="contacts_space">
        <div class="container" >
            <div class="row aroma_container">
                <div class="col-md-9 col-sm-9" >
                    <div class="sort">
                        Сортировать:
                        <a href="?{% url_replace request 'ordering' '-year' %}" {% if request.GET.ordering == '-year' or not request.GET.ordering %}
                           class='selected'{% endif %}>по новизне</a>
                        <a href="?{% url_replace request 'ordering' '-aromacounter__num_comments' %}"
                                {% if request.GET.ordering == '-aromacounter__num_comments' %}
                           class='selected'{% endif %}>по популярности</a>
                    </div>
                
                    {% for item in data.results %}
                        {{ item.title }}{{ item.year }}<br/>
                    {% endfor %}
                    <div class="center">
                        {% include 'rest_framework/pagination/numbers.html' with previous_url=data.previous_url next_url=data.next_url page_links=data.page_links %}
                    </div>
                </div>
                <div class="col-md-3 col-sm-3">
                    <form name="search_form" id="search_form" method="GET">
                        {% crispy form %}
                        <button type="submit" class="btn btn-search">Применить</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block extra_javascript %}
    <script>
        $('#search_form').on('change', function(){
            $('#search_form').submit();
        });
    </script>
{% endblock %}
